/*
 * Panes.js - 0.0.2-4 
 * Author : Jacob Lowe <http://jacoblowe.me> 
 */

!function(a,b){var c=function(a,b){return this instanceof c?(this.locked=null,this.current=1,this.position=0,this.direction="vertical"===b?0:1,this.ele=a,this.els=a.find("> *"),this.top=this.direction?a.position().left:a.position().top,this.view=this.direction?this.els.outerWidth(!0):this.els.outerHeight(!0),this.threshold=this.view/10,this.animating=0,this.max=this.els.length,this.touch="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1,this.transform=function(){var a,c=document.body||document.documentElement,d=c.style,e="transform";if("string"==typeof d[e])return e;a=["Moz","Webkit","Khtml","O","ms"],e=e.charAt(0).toUpperCase()+e.substr(1);for(var f=0;f<a.length;f++)if("string"==typeof d[a[f]+e])return a[f]+e;return b?"top":"left"}(),this.transition=function(){var a,b=document.body||document.documentElement,c=b.style,d="transition";if("string"==typeof c[d])return d;a=["Moz","Webkit","Khtml","O","ms"],d=d.charAt(0).toUpperCase()+d.substr(1);for(var e=0;e<a.length;e++)if("string"==typeof c[a[e]+d])return a[e]+d;return null}(),this.prefixed=this.transition?"-"+this.transform.split(/tran/i).join("-tran").toLowerCase():null,this.ele.css(this.transform,this.Css(0)),this.eleTop=this.Css(a),this.move=/transform/.test(this.transform)?"animate":"css",this.axis=this.direction?"width":"height",this.page=this.direction?"pageX":"pageY",this.init(),void 0):new c(a,b)};c.prototype.lock=function(){this.locked=!0},c.prototype.speed=null,c.prototype.Css=function(a){return a instanceof jQuery?/transform/i.test(this.transform)?this.direction?parseFloat(a.css(this.transform).split(/\(/)[1].split(/\,/)[4]):parseFloat(a.css(this.transform).split(/\(/)[1].split(/\,/).pop()):a.css(this.transform):/transform/i.test(this.transform)?this.direction?"translate3d("+(/px/.test(a)?a:a+"px")+",0,0)":"translate3d(0,"+(/px/.test(a)?a:a+"px")+",0)":a},c.prototype.goto=function(a,b){var c,d={},e=this;return this.current!==a&&(c=!0),this.prev=this.current,a=parseFloat(a),1>a||a>this.max?!1:(this.current=a,d[this.transform]=this.Css(-(this.view-2)*(a-1)),this.transition&&(d[this.transition]=e.prefixed+" "+b+"s ease-out 0s"),this.animating=1,this.ele[this.move](d),setTimeout(function(){e.animating=0,e.ele.removeClass("animate"),e.onChange&&c&&e.onChange(e.current,e.els.length)},500),void 0)},c.prototype.events=function(){var a=this;this.clock=function(){var b=a.position;setTimeout(function(){b=a.position-b,a.speed=b/50},50)},this.drag=function(b){if(b.preventDefault(),a.start&&!a.animating&&!a.locked){var c=b.originalEvent.touches[0][a.page],d=c-a.top-a.start,e=d+a.eleTop;a.onScroll&&a.onScroll(d),a.ele.css(a.transform,a.Css(e)),a.position=d}},this.dragend=function(){if(clearInterval(a.timer),!a.locked){a.onScrollStop&&a.onScrollStop();var b=a.speed<0?-1*a.speed:a.speed,c=this.position<0?-1*this.position:this.position,d=b?(this.view-c)/b/1e3:".5";(a.position>a.threshold||.5>d&&this.position>0)&&1!==a.current?(d>.5&&(d=.5),a.goto(a.current-1,d)):(a.position<-1*a.threshold||.5>d&&this.position<0)&&a.current!==a.max?(d>.5&&(d=.5),a.goto(a.current+1,d)):a.goto(a.current,.5)}},this.touchStart=function(b){a.time=0,a.timer=setInterval(a.clock,50),a.position=0;var c={};a.transition&&(c[a.transition]="none"),b.preventDefault(),a.start=b.originalEvent.touches[0][a.page]-a.top,a.eleTop=a.Css(a.ele),a.ele.css(c).bind("touchmove",a.drag)},this.touchEnd=function(b){a.animating||(b.preventDefault(),a.start=null,a.dragend(),a.ele.unbind("touchmove",a.drag))}},c.prototype.listen=function(){this.ele.on("touchstart",this.touchStart),this.ele.on("touchend",this.touchEnd)},c.prototype.init=function(){var a={};a[this.axis]=this.els.length*this.view+"px",this.ele.css(a),this.events(),this.listen()},b.Panes=c}(jQuery,this),function(a){var b=function(a){this.els=a,this.panes=[]};b.prototype.getContent=function(){els.each(function(){var a=$(this);this.panes.push({content:a.html(),classes:a.attr("class")})})},a.PanesRecycler=b}(this);